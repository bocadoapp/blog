{"componentChunkName":"component---src-templates-post-js","path":"/blog-hecho-en-react-wordpress/","result":{"data":{"wordpressPost":{"id":"6fabfc9c-a58d-5208-b26a-8fed276858ee","title":"C√≥mo hemos construido el blog en React y gestionado con&nbsp;WordPress","slug":"blog-hecho-en-react-wordpress","content":"\n<p>C√≥mo el dinero no es un elemento que sobre en este proyecto, pero a√∫n as√≠ quer√≠amos hacer algo auto-gestionado y &#8216;a la moda&#8217;, esta ser√° la hist√≥ria de c√≥mo hemos logrado montar un blog en <strong>React</strong> con el framework <strong>Gatsby</strong> gestionado por <strong>WordPress</strong> 100% gratuito.</p>\n\n\n\n<h2>El plan</h2>\n\n\n\n<p>El plan estaba claro desde el inicio. WordPress ten√≠a que ser usado c√≥mo <em><a href=\"https://en.wikipedia.org/wiki/Headless_content_management_system\" target=\"_blank\" rel=\"noreferrer noopener\">headless CMS</a></em> y el front s√≥lo pod√≠a estar hecho en React (üíñ‚öõÔ∏è).</p>\n\n\n\n<p>Concretamente con <a rel=\"noreferrer noopener\" href=\"https://www.gatsbyjs.org/\" target=\"_blank\">Gatsby</a>, que dispone de un data source para <a rel=\"noreferrer noopener\" href=\"https://wordpress.com/\" target=\"_blank\">WordPress</a>, hac√≠a tiempo que quer√≠a probarlo. Adem√°s no nos enga√±emos, no hay experiencia m√°s placentera que navegar por una p√°gina <strong>SSG</strong> (<em>Static Site Generator</em>, p√°gina generada est√°ticamente).</p>\n\n\n\n<p>Eso quiere decir que las queries a la API de WordPress se hacen en tiempo de compilaci√≥n, no de ejecuci√≥n, ah√≠ es cuando el data source se encarga de consultar la API de WordPress transformar los datos para encajar el esquema de Gatsby, que bien pensado. ‚ú®</p>\n\n\n\n<p>WordPress a parte de ofrecer la versi√≥n descargable dispone de una versi√≥n gratuita alojada por ellos. Es bastante limitada (tienes que pagar para usar plugins), pero cumple su funci√≥n, adem√°s te permite usar la API, y as√≠ poderlo usar c√≥mo headless CMS.</p>\n\n\n\n<ul><li>Voy a WordPress.com, me registro y creo un blog, todo en orden.</li><li>Para poder usar la API necesitas crear una aplicaci√≥n que te generar√° una id y un secret para autenticarte v√≠a plugin de Gatsby gatsby-source-wordpress.</li><li>Deshabilitar el blog de aparecer en los buscadores te ahorrar√° problemas de contenido duplicado.</li></ul>\n\n\n\n<p>Raquel me hab√≠a creado ya unos mockups en Zeplin para saber por donde tirar, as√≠ que r√°pidamente instalo el starter <a href=\"https://www.gatsbyjs.org/starters/gatsbycentral/gatsby-starter-wordpress/\" target=\"_blank\" rel=\"noreferrer noopener\"><strong>gatsby-starter-wordpress</strong></a>, configuro los datos de conexi√≥n con la API de WordPress le paso una capa de pintura para que se parezca algo al mockup y ¬°listos! üöÄ</p>\n\n\n\n<pre class=\"wp-block-preformatted\">plugins: [\n  {\n    resolve: 'gatsby-source-wordpress',\n    options:\n      {\n        baseUrl: 'bocadoblog.wordpress.com',\n        hostingWPCOM: true,\n        protocol: 'https',\n        useACF: false,\n        auth: {\n          wpcom_app_clientSecret: \"XXX\",\n          wpcom_app_clientId: \"XXX\",\n          wpcom_user: \"XXX\",\n          wpcom_pass: \"XXX\"\n        },\n        verboseOutput: true,\n        includedRoutes: [\n          \"**/categories\",\n          \"**/posts\",\n          \"**/pages\",\n          \"**/media\",\n          \"**/tags\"\n        ]\n    }\n  }\n]</pre>\n\n\n\n<figure class=\"wp-block-image size-large\"><img data-attachment-id=\"50\" data-permalink=\"https://bocadoblog.wordpress.com/screenshot-2020-04-12-at-16-41-54/\" data-orig-file=\"https://bocadoblog.files.wordpress.com/2020/04/screenshot-2020-04-12-at-16.41.54.png\" data-orig-size=\"2880,1800\" data-comments-opened=\"1\" data-image-meta=\"{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}\" data-image-title=\"screenshot-2020-04-12-at-16.41.54\" data-image-description=\"\" data-medium-file=\"https://bocadoblog.files.wordpress.com/2020/04/screenshot-2020-04-12-at-16.41.54.png?w=300\" data-large-file=\"https://bocadoblog.files.wordpress.com/2020/04/screenshot-2020-04-12-at-16.41.54.png?w=750\" src=\"https://bocadoblog.files.wordpress.com/2020/04/screenshot-2020-04-12-at-16.41.54.png?w=1024\" alt=\"\" class=\"wp-image-50\" srcset=\"https://bocadoblog.files.wordpress.com/2020/04/screenshot-2020-04-12-at-16.41.54.png?w=1024 1024w, https://bocadoblog.files.wordpress.com/2020/04/screenshot-2020-04-12-at-16.41.54.png?w=2048 2048w, https://bocadoblog.files.wordpress.com/2020/04/screenshot-2020-04-12-at-16.41.54.png?w=150 150w, https://bocadoblog.files.wordpress.com/2020/04/screenshot-2020-04-12-at-16.41.54.png?w=300 300w, https://bocadoblog.files.wordpress.com/2020/04/screenshot-2020-04-12-at-16.41.54.png?w=768 768w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" /></figure>\n\n\n\n<h3>Alojamiento: Github Pages</h3>\n\n\n\n<p>Para alojar de forma gratuita el front me decid√≠ por <a href=\"https://pages.github.com/\" target=\"_blank\" rel=\"noreferrer noopener\">Github Pages</a>, es muy f√°cil de configurar. Para utilizar nuestro dominio s√≥lo tuve que crear un registro CNAME en el provider del dominio y crear un archivo CNAME en la ra√≠z del repositorio con la URL.</p>\n\n\n\n<p>Para publicar desde mi m√°quina, con este simple comando en el <code>package.json</code> no tuve problema:</p>\n\n\n\n<pre class=\"wp-block-preformatted\">{\n  \"deploy\": \"gatsby build --prefix-paths &amp;&amp; gh-pages -d public\"\n}</pre>\n\n\n\n<h3>El problema</h3>\n\n\n\n<p>Cuando ya lo ten√≠a listo me di cuenta de cu√°l era el problema üòû<br>Cuando se publica un post, Github pages no lo sabe, por lo tanto no se hace un deploy y no  se actualiza la p√°gina, ¬°Qu√© desastre! üëπ</p>\n\n\n\n<p>La soluci√≥n</p>\n\n\n\n<p><a href=\"https://travis-ci.org/\" target=\"_blank\" rel=\"noreferrer noopener\">Travis CI </a>y los hooks de WordPress.</p>\n\n\n\n<p>Configur√© Travis para hacer los builds ah√≠, es gratuito mientras el c√≥digo est√© abierto. Aprovech√© para configurar que cada push a master se haga deploy, con lo cual tamb√≠en lo utilizo para el desarrollo en local.</p>\n\n\n\n<p>Ah√≠ va lo bueno, para solucionar el problema s√≥lo tuve que configurar los webhooks del blog en WordPress.com para que llamen a la API de Travis y se dispare un deploy, y ¬°voil√°!</p>\n\n\n\n<p>Ya tengo auto-deploys, alojamiento y CMS gratuito üëèüëèüëè</p>\n","date":"April 06, 2020","categories":[{"name":"Dietario","slug":"dietario"}],"author":4092,"image":"https://bocadoblog.files.wordpress.com/2020/04/diagram.png"}},"pageContext":{"isCreatedByStatefulCreatePages":false,"id":"6fabfc9c-a58d-5208-b26a-8fed276858ee"}}}